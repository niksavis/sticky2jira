# Sticky2Jira

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)

Browser-based local application that extracts text from sticky note images using OCR and creates/updates Jira issues.

## Features

- **100% Local Processing** - No cloud APIs, all OCR processing happens on your machine using PaddleOCR (pure Python)
- **11-Color Detection** - Automatically detects red, orange, yellow, lime, green, cyan, blue, violet, pink, gray, and black sticky notes
- **Spatial Linking** - Links description stickies to nearby summary stickies
- **Jira Integration** - Creates new issues or updates existing ones (prevents duplicates)
- **Interactive UI** - Step-by-step wizard interface with real-time progress
- **Secure** - API tokens encrypted with AES-128, stored locally in SQLite
- **Offline Capable** - All frontend assets self-hosted, works without internet after setup

## Requirements

- **Python 3.8+** - Required for Flask backend
- **Windows OS** - Batch scripts designed for Windows
- **Internet connection** - Only needed for initial setup (downloading Python packages)

## Installation

1. **Clone/download this repository** to your local machine

2. **Run the installation script:**

   ```cmd
   install.bat
   ```

   This will:
   - Create Python virtual environment (`.venv`)
   - Install all Python dependencies including PaddleOCR (pure Python, no binaries)
   - Download frontend libraries (Bootstrap, jQuery, DataTables, Socket.IO)
   - Create `.env` configuration file
   - Generate `launch.bat` startup script

3. **Wait for installation to complete** (may take 5-10 minutes for PaddleOCR and dependencies)

4. **Run the application:**

   ```cmd
   launch.bat
   ```

   Browser opens automatically to `http://localhost:5000`

## Quick Start Guide

### 1. Configure Jira Connection

- **Setup Tab**: Enter Jira server URL, username, and API token ([create token](https://id.atlassian.com/manage-profile/security/api-tokens))
- Click "Test Connection" then "Save Settings"

### 2. Process Sticky Note Image

- **Upload Tab**: Select image (max 5MB), click "Upload Image"
- **OCR Tab**: Click "Start OCR Processing", wait for text extraction
- **Mapping Tab**: Select project, map sticky colors to issue types (Task/Bug/Story)

### 3. Review and Import

- **Issues Tab**: Review detected issues, edit summaries/descriptions inline
- **Import Tab**: Click "Start Import" to create/update Jira issues
- **Results Tab**: View import summary with clickable Jira links

### Tips

- **Prevent duplicates**: Issues with existing `issue_key` are updated, not recreated
- **Multi-image workflow**: Click "New Import" before processing new images
- **Best image quality**: 300+ DPI, high contrast, clear text

## Configuration

### Environment Variables (`.env`)

Optional `.env` file for custom settings (created by `install.bat`, but currently empty by default):

```bash
# Flask server settings
FLASK_HOST=127.0.0.1
FLASK_PORT=5000
FLASK_DEBUG=False
```

### Advanced OCR Tuning

Edit `services/ocr_service.py` constants:

```python
DEFAULT_HSV_TOLERANCE = 20  # Color detection sensitivity
DEFAULT_MIN_SIZE = 50       # Minimum sticky note size (pixels)
DEFAULT_PROXIMITY = 100     # Linking threshold (pixels)
```

### OCR Color Ranges

The application supports 11 colors based on HSV analysis. Modify `services/ocr_service.py` to adjust ranges:

```python
OCR_COLOR_RANGES = {
    'red': (np.array([0, 60, 200]), np.array([8, 255, 255])),      # H=0-8
    'orange': (np.array([9, 80, 200]), np.array([22, 255, 255])),  # H=9-22
    'yellow': (np.array([23, 60, 200]), np.array([37, 255, 255])), # H=23-37
    'lime': (np.array([38, 60, 180]), np.array([65, 255, 255])),   # H=38-65 (yellow-green)
    'green': (np.array([66, 60, 180]), np.array([84, 255, 255])),  # H=66-84
    'cyan': (np.array([85, 50, 200]), np.array([100, 255, 255])),  # H=85-100 (teal)
    'blue': (np.array([101, 50, 200]), np.array([117, 255, 255])), # H=101-117
    'violet': (np.array([118, 50, 200]), np.array([154, 255, 255])), # H=118-154
    'pink': (np.array([155, 30, 200]), np.array([180, 255, 255])), # H=155-180
    'gray': (np.array([0, 0, 180]), np.array([180, 30, 255])),     # Low saturation
    'black': (np.array([0, 0, 0]), np.array([180, 255, 100])),     # Low value
}
```

## Project Structure

```text
sticky2jira/
├── app.py                      # Flask application entry point
├── install.bat                 # Automated installation script
├── launch.bat                  # Startup script (generated by install.bat)
├── download_libs.bat           # Frontend library downloader
├── requirements.in             # Source dependencies
├── requirements.txt            # Compiled dependencies (generated)
├── .env                        # Environment configuration
├── .gitignore                  # Git ignore rules
├── services/                   # Business logic layer
│   ├── session_manager.py      # SQLite database operations
│   ├── jira_service.py         # Jira API integration
│   ├── ocr_service.py          # OCR processing with OpenCV/PaddleOCR
│   └── crypto_utils.py         # AES-128 encryption for API tokens
├── templates/                  # HTML templates
│   └── index.html              # Main SPA interface
├── static/                     # Frontend assets
│   ├── css/
│   │   └── app.css             # Custom styles
│   ├── js/
│   │   └── app.js              # Application logic + SocketIO
│   └── libs/                   # Self-hosted libraries
│       ├── bootstrap-5.3.0/
│       ├── jquery-3.7.0/
│       ├── datatables-1.13/
│       └── socket.io-4.5.4/
├── uploads/                    # Uploaded images (git-ignored)
├── jira_templates/             # Generated Jira field templates (git-ignored)
├── session.db                  # SQLite database
├── app.log                     # Application logs
└── errors.log                  # Error logs
```

## Troubleshooting

**OCR not working**: Ensure Python 3.8+, reinstall dependencies: `.venv\Scripts\activate` then `pip install --upgrade paddleocr paddlepaddle`

**Blank page**: Run `download_libs.bat` to download Bootstrap/jQuery/DataTables/Socket.IO to `static/libs/`

**Poor text extraction**: Use 300+ DPI images, adjust `DEFAULT_HSV_TOLERANCE` in `services/ocr_service.py`

**Jira connection fails**: Verify URL format `https://company.atlassian.net` (no trailing slash), check API token validity

**Duplicate issues**: Click "New Import" before processing new images (issues with `issue_key` are updated, not recreated)

**Port conflict**: Create `.env` file and set `FLASK_PORT=5001`

## Security & Privacy

- **Encrypted credentials**: Jira API tokens encrypted with AES-128 Fernet, key stored in `.encryption_key` (git-ignored)
- **100% local processing**: All OCR runs on your machine with PaddleOCR (pure Python, no external binaries or cloud APIs)
- **Localhost only**: Flask server binds to `127.0.0.1` (not accessible from network)
- **Session data**: Stored in `session.db` SQLite database (git-ignored)

## Technical Stack

- **Backend**: Flask + Flask-SocketIO, SQLite, Python 3.8+
- **OCR**: PaddleOCR 2.7+ (pure Python), OpenCV, NumPy
- **Frontend**: Vanilla JS, Bootstrap 5.3.0, DataTables.js, Socket.IO (all self-hosted)
- **Jira**: jira Python library
- **Security**: cryptography (Fernet/AES-128 encryption)

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## Acknowledgments

- [PaddleOCR](https://github.com/PaddlePaddle/PaddleOCR) - Pure Python OCR engine
- [Flask](https://flask.palletsprojects.com/) - Web framework
- [Bootstrap](https://getbootstrap.com/) - Frontend framework

---

**Status:** Beta  
**Last Updated:** November 22, 2025
